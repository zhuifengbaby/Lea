@{
    ViewBag.Title = "表单页面";
    Layout = "~/Views/Shared/_Form.cshtml";
}
<script>
    var keyValue = request('keyValue');
    $(function () {
        InitialPage();
        initControl();

    });
    //初始化控件
    function initControl() {
        //获取表单
        if (!!keyValue) {
            $.SetForm({
                url: "../../BaseManage/H_RenInfo/GetFormJson",
                param: { keyValue: keyValue },
                success: function (data) {
                    $("#form1").SetWebControls(data);
                }
            })
        }
    }

    function InitialPage() {
        $("#JZRenType").ComboBox({
            url: "../../SystemManage/DataItemDetail/GetDataItemListJson",
            param: { EnCode: "JZRenType" },
            id: "ItemValue",
            text: "ItemName",
            description: "请选择",
            height: "200px"
        });
        $("#ZhiYe").ComboBox({
            url: "../../SystemManage/DataItemDetail/GetDataItemListJson",
            param: { EnCode: "ZhiYe" },
            id: "ItemValue",
            text: "ItemName",
            description: "请选择",
            height: "200px"
        });
        $("#ImpRen").ComboBox({
            url: "../../SystemManage/DataItemDetail/GetDataItemListJson",
            param: { EnCode: "ImpRen" },
            id: "ItemValue",
            text: "ItemName",
            description: "请选择",
            height: "200px"
        });
        $("#Sex").ComboBox({
            url: "../../SystemManage/DataItemDetail/GetDataItemListJson",
            param: { EnCode: "Sex" },
            id: "ItemValue",
            text: "ItemName",
            description: "请选择",
            height: "200px"
        });
        var role = '@LeaRun.Application.Code.OperatorProvider.Provider.Current().CompanyId';
        if (role == "镇联动中心") {
            role = "";
        }
        $("#AllAddress").ComboBox({
            url: "../../SystemManage/DataItemDetail/GetDataItemListJsonAllAddress",
            param: { EnCode: role },
            id: "ItemValue",
            text: "ItemName",
            description: "请选择",
            height: "400px",
            allowSearch: true
        }).change(function () {
            var AllAddress = $(this).attr('data-value');
            var queryJson = {
                AllAddress: AllAddress
            }
            $.ajax({
                method: 'get',
                url: '../../BaseManage/H_RenInfo/GetListJson2',
                data: { queryJson: JSON.stringify(queryJson) },
                dataType: "json",
                success: function (data) {
                    if (data.length > 0) {
                        var Address = data[0].Address;
                        $('#Address').val(Address);
                        var Arear = data[0].Arear;
                        $('#Arear').val(Arear);
                        var ArearNumber = data[0].ArearNumber;
                        $('#ArearNumber').val(ArearNumber);
                        var HouseType = data[0].HouseType;
                        $('#HouseType').val(HouseType);
                        var CodeNumber = data[0].CodeNumber;
                        $('#CodeNumber').val(CodeNumber);
                        var CQRen = data[0].CQRen;
                        $('#CQRen').val(CQRen);
                    }
                    else {
                        alert("请先选择房屋");
                    }
                }
            })

        })
    };

    //保存表单;
    function AcceptClick() {
        if (!$('#form1').Validform()) {
            return false;
        }
        var postData = $("#form1").GetWebControls(keyValue);
        $.SaveForm({
            url: "../../BaseManage/H_RenInfo/SaveForm?keyValue=" + keyValue,
            param: postData,
            loading: "正在保存数据...",
            success: function () {
                $.currentIframe().$("#gridTable").trigger("reloadGrid");
            }
        })
    }
</script>
<div style="margin-top: 20px; margin-right: 30px;">
    <table class="form">
        <tr style="">
            <td colspan="5" style=" "><div style="border-bottom: 1px solid #e2e2e2; font-weight: 700; font-size: 17px; padding-bottom: 12px; color: #1868ad; margin-bottom: 12px; ">&nbsp&nbsp房屋信息</div></td>
        </tr>
        <tr>
            <td class="formTitle">坐落详址(全)</td>
            <td class="formValue">
                <div id="AllAddress" type="select" class="ui-select"></div>
                @*<input id="AllAddress" type="text" class="form-control" />*@
            </td>
        </tr>

        <tr>
            <td class="formTitle">村居</td>
            <td class="formValue">
                <input id="Arear" type="text" class="form-control" readonly="readonly" />
            </td>
            <td class="formTitle">网格名称</td>
            <td class="formValue">
                <input id="ArearNumber" type="text" class="form-control" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">坐落详址</td>
            <td class="formValue">
                <input id="Address" type="text" class="form-control" readonly="readonly" />
            </td>
            <td class="formTitle">房屋性质</td>
            <td class="formValue">
                <input id="HouseType" type="text" class="form-control" readonly="readonly" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">二维码门牌</td>
            <td class="formValue">
                <input id="CodeNumber" type="text" class="form-control" readonly="readonly" />
            </td>
            <td class="formTitle">产权人</td>
            <td class="formValue">
                <input id="CQRen" type="text" class="form-control" readonly="readonly" />
            </td>
        </tr>
        <tr style="">
            <td colspan="5" style=" "><div style="border-bottom: 1px solid #e2e2e2; font-weight: 700; font-size: 17px; padding-bottom: 12px; color: #1868ad; margin-bottom: 12px; ">&nbsp&nbsp人员信息</div></td>
        </tr>
        <tr>
            <td class="formTitle">身份证号码<font face="宋体">*</font></td>
            <td class="formValue">
                <input id="IDCard" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
            </td>
            <td class="formTitle">居住人姓名<font face="宋体">*</font></td>
            <td class="formValue">
                <input id="JZRenName" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">性别<font face="宋体">*</font></td>
            <td class="formValue">
                <div id="Sex" type="select" class="ui-select" isvalid="yes" checkexpession="NotNull"></div>
                @*<input id="Sex" type="text" class="form-control"  />*@
            </td>
            <td class="formTitle">户籍信息</td>
            <td class="formValue">
                <input id="HJInfo" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">居住人员类别<font face="宋体">*</font></td>
            <td class="formValue">
                <div id="JZRenType" type="select" class="ui-select" isvalid="yes" checkexpession="NotNull"></div>
                @*<input id="JZRenType" type="text" class="form-control"  />*@
            </td>
            <td class="formTitle">居住证号码</td>
            <td class="formValue">
                <input id="JZNumber" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">联系电话<font face="宋体">*</font></td>
            <td class="formValue">
                <input id="Phone" type="text" class="form-control" isvalid="yes" checkexpession="NotNull" />
            </td>
            <td class="formTitle">应急联系电话</td>
            <td class="formValue">
                <input id="Phone2" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">实际居住地址</td>
            <td class="formValue">
                <input id="SJJZAddress" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">职业</td>
            <td class="formValue">
                <div id="ZhiYe" type="select" class="ui-select"></div>
                @*<input id="ZhiYe" type="text" class="form-control" />*@
            </td>
            <td class="formTitle">工作所在地</td>
            <td class="formValue">
                <input id="WordAddress" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">重点人员</td>
            <td class="formValue">
                <div id="ImpRen" type="select" class="ui-select"></div>
                @*<input id="ImpRen" type="text" class="form-control" />*@
            </td>
            <td class="formTitle">具体情况</td>
            <td class="formValue">
                <input id="JTQingKuang" type="text" class="form-control" />
            </td>
        </tr>
        <tr>
            <td class="formTitle">备注</td>
            <td class="formValue">
                <input id="Note" type="text" class="form-control" />

    </table>
</div>
